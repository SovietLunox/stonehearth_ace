<script type="text/x-handlebars" data-template-name="fenceMode">
<div id="fenceMode" class="gui">
   <div id="fenceSegmentsDiv">
      {{#each segment in view.segments}}
      <div class="fenceSegmentContainer">
         <a href="#" {{action "selectSegment" segment target="view"}} {{bind-attr data-uri=segment.uri class=":fenceSegmentBtn segment.enabled:enabled:disabled"}}>
            <img class="fenceSegmentImg" {{bind-attr src=segment.icon}}/>
            <div class="selectBox"></div>
         </a>
         <a href="#" {{action "toggleSegment" segment target="view"}} {{bind-attr data-index=_view.contentIndex class=":toggleSegmentBtn segment.enabled:enabled:disabled"}}>
            <img class="toggleSegmentImg"/>
         </a>
         <a href="#" {{action "buildFromSegment" segment target="view"}} {{bind-attr data-index=_view.contentIndex class=":buildFromSegmentBtn segment.enabled::hidden"}}>
            <img class="buildFromSegmentImg"/>
         </a>
         <a href="#" {{action "buildSegment" segment target="view"}} {{bind-attr data-index=_view.contentIndex class=":buildSegmentBtn segment.crafterRequirement::hidden"}}>
            <img class="buildSegmentImg"/>
         </a>
      </div>
      {{/each}}
      <a href="#" {{action "insertSegment" target="view"}} id="addSegmentBtn" {{bind-attr class="view.canAddSegment::hidden"}}>
         <img id="addSegmentImg"/>
      </a>
   </div>
   <div id="fenceControls">
      <a id="showLoadPreset" class="button" href="#" {{action "showLoadPreset" target="view"}}>
         <img class="presetsImg"/>
      </a>
      <a id="showSavePreset" class="button" href="#" {{action "showSavePreset" target="view"}}>
         <img class="savePresetImg"/>
      </a>
      <a id="reverseSegments" class="button" href="#" {{action "reverseSegments" target="view"}}>
         <img class="reverseSegmentsImg"/>
      </a>
   </div>

   <div id="presetSelection">
      <input id="presetSearch" type="text" {{bind-attr value=view.presetSearch}} />
      {{#if view.inSaveMode}}
      <div class="presetButtons">
         <a href="#" {{action "saveCurrentPreset" target="view"}} {{bind-attr class=":savePreset :button view.saveAllowed:enabled:disabled"}}>
            <img class="savePresetImg"/>
         </a>
      </div>
      {{/if}}
      <div id="presetList">
         {{#each preset in view.presets}}
         <div {{bind-attr data-name=preset.name class=":presetRow preset.default:default: preset.available::unavailable"}}>
            <div class="presetPreview">
               {{#each segment in preset.segments}}
               <img {{bind-attr src=segment.icon data-uri=segment.uri class=":presetSegmentImg segment.enabled:enabled:disabled"}}/>
               {{/each}}
            </div>
            <div class="presetButtons">
               {{#if view.inLoadMode}}
               <a class="loadPreset button" href="#" {{action "loadPreset" preset target="view"}}>
                  <img class="loadPresetImg"/>
               </a>
               {{/if}}
               {{#if view.inSaveMode}}
                  {{#if preset.default}}
                  {{else}}
                  <a class="savePreset button" href="#" {{action "savePreset" preset target="view"}}>
                     <img class="savePresetImg"/>
                  </a>
                  {{/if}}
               {{/if}}
               {{#if preset.default}}
               {{else}}
               <a class="deletePreset button" href="#" {{action "deletePreset" preset target="view"}}>
                  <img class="deletePresetImg"/>
               </a>
               {{/if}}
            </div>
         </div>
         {{/each}}
      </div>
   </div>

   <div id="segmentSelection">
      <div id="allSegments">
         {{#each segment in view.allSegments}}
         <a href="#" {{action "setSegment" segment.uri target="view"}} {{bind-attr data-uri=segment.uri class=":segmentDiv segment.available::unavailable"}}>
            <img {{bind-attr src=segment.icon}}/>
            <div class="selectBox"></div>
         </div>
         {{/each}}
      </div>
   </div>
</div>
</script>
